\documentclass{article}
\usepackage{cancel}
\usepackage[utf8]{inputenc}
\usepackage {titlesec}
\usepackage[english,russian]{babel}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{numprint}
\graphicspath{{pictures/}}

\titlespacing*{\section}{\parindent}{*4}{*4}

\title{Домашнее задание 14}
\author{Ткачев Андрей, группа 166}
\date{\today}
\newcommand{\niton}{\not\owns}
\newcommand{\pr}{^{\prime}}
\newcommand{\ppr}{^{\prime\prime}}
\newcommand{\xp}{x^{\prime}}
\newcommand{\xpp}{x^{\prime\prime}}
\newcommand{\xppp}{x^{\prime\prime\prime}}
\newcommand{\pair}[2]{(#1,\ #2)}
\newcommand{\andi}{$ и $}
\newcommand{\half}[1]{\frac{#1}{2}}

\begin{document}
	\maketitle
	\paragraph{Задача 1.}

    Выигрыш - это случайная величина. Если суммарная стоимость $N$ билетов $100N$ штук, то сумма выигрыша $40N$, тогда средний выигрыш - $\frac{40N}{N} = 40$. Тогда если $f$ - выигрыш, то $E[f] = 40$.

    По неравенству Маркова $Pr[f \ge 5000] \le \frac{E[f]}{5000} = \frac{40}{5000} = 0.008 < 0.01 $. Т.е. вероятность выиграть 5000 меньше $1\%$.

    \paragraph{Задача 2.}
    Продолжительность жизни $f$ - случайная величина, $E[f] = 26$. Из условия $Pr[f \le 8] = \half{1} \Rightarrow$ ровно половина людей прожила строго больше 8 лет.
    Число людей, живших в указанном году $N$. Рассмотрим два крайних случая:

    \begin{enumerate}
        \item Ровно половина людей жила ровно 8 лет, а остальные - больше 8 лет.
        \item Ровно половина людей жила ровно 0 лет, а остальные - больше 8 лет.
    \end{enumerate}

    В первом случая средняя продолжительность жизни тех, кто прожил не меньше 8 лет ($\ge 8$) есть $E[f]$, т.е. 26 лет.

    Во втором случае пусть $x$ - средняя продолжительность жизни тех, кто прожил не меньше (а значит в данном случае больше) 8-ми лет. Тогда $\half{N} \cdot 0  + \half{N} \cdot x = E[f] \cdot N$ (суммарный возраст всех людей $N \cdot E[f]$, из них половина имеет средний возраст 0, а вторая $x > 8$), откуда $x = 52$.

    Таким образом средняя продолжительность жизни людей, проживших не меньше 8 лет может принимать одно из значений от $26$ до $52$ включительно.

    \paragraph{Задача 3.}
    \subparagraph{Кубик честный.}
    Броски первого игрока будем обозначать парой чисел $(x,\ y)$, $1 \le x,\ y \le 6$. Каждая из пар $\pair{x}{y}$ выпадает с вероятностью $\frac{1}{36}$. Тогда ожидание выигрыша $f_1$ первого игрока 
    $$E[f_1] = \frac{1}{36}\sum_{x=1}^{6}\sum_{y=1}^{6} xy = \frac{1}{36} \sum_{x=1}^{6} x \sum_{y=1}^{6} y = \frac{21^2}{36} = 12.25.$$

    Средний же выигрыш второго игрока - это среднее арифметическое значение суммы квадратов первых 6 натуральных числел: $E[f_2] = \frac{1^2 + 2^2 + \ldots + 6^2}{6} = \frac{91}{6} = 15\frac{1}{6}$.

    Таким образом средний выигрыш второго игрока больше.

    \subparagraph{Кубик нечестный.}
    Пусть вероятности выпадения граней $p_1, p_2, \ldots p_6$.

    Тогда по анологии с прошлым пунктом ожидание выиграша первого игрока 

    $$E[f_1] = \sum_{x=1}^{6}\sum_{y=1}^{6} (x \cdot p_x) \cdot (y \cdot p_y) = 
    \sum_{x=1}^{6} (x \cdot p_x) \cdot \sum_{y=1}^{6} (y \cdot p_y) = (\sum_{x=1}^{6} xp_x)^2$$

    Ожидание же выигрыша второго игрока:

    $$E[f_2] = \sum_{x=1}^{6} x^2p_x.$$

    Рассмотрим случайную величину $f_3$ принимающую целые значения от 1 до 6 с вероятностями $p_1, \ldots, p_6$. $E[f_3] = \sum_{x=1}^{6} xp_x$. Тогда дисперсия $f_3$: 

    $$D[f_3] = E[f_3^2] - (E[f_3])^2 = \sum_{x=1}^{6} x^2p_x - (\sum_{x=1}^{6} xp_x)^2 = E[f_2] - E[f_1]$$

    Но дисперсия - вличина не отрицательная $\Rightarrow$ $E[f_1] - E[f_2] \ge 0$. Таким образом 
     $$E[f_1] \le E[f_2]$$

    Значит в общем случае выигрыш первого игрока в среднем не больше выигрыша второго.


    \paragraph{Задача 4.}
    Пусть $f$ - случайная величина равная числу вхождения подслова $ab$ в данное слово. Через $g_i$ обозначим случайную величину, принимающую значение 1, если символы $i$ и $i + 1$ образуют слово $ab$ (порядок важен) и 0, в противном случае.

    Тогда $f = \sum_{i=1}^{20 - 1} g_i$. В силу линейностити математического ожидания $E[f] = E[\sum_{i=1}^{20 - 1} g_i] = \sum_{i=1}^{20 - 1} E[g_i]$. 

    Посчитаем ожидание случайной величины $g_i$. Несложно видеть, что вероятность события $A$ <<символы $i$ и $i + 1$ образуют слово $ab$>> в вероятностном пространстве слов $\{a,\ b\}^20$:
    $$Pr[A] = \frac{2^{20 - 2}}{2^{20}} = \frac{1}{4}$$

    Таким образом $E[g_i] = \frac{1}{4} \cdot 1 + \frac{1}{4} \cdot 0 = \frac{1}{4}$.
    Получаем $E[f] = \sum_{i=1}^{20 - 1} \frac{1}{4} = \frac{19}{4}$.

    \textbf{Ответ:} $\frac{19}{4}$.

    \paragraph{Задача 5.}
    Пусть $f$ - случайная величина, показывающая число различных завтраков в трехнедельном рационе проректора. Введем случайную величину $g_i$ принимающую значение 1, если завтрак $i$ был съеден за все время проректором и 0 - в противном случае.

    Посчитаем $E[g_i]$. В вероятностном просранстве всех возможных комбинаций завтраков, коих $10^{15}$, найдем вероятность события $A$ <<$i$ завтрак будет входить в один из 15 съеденных нашим трудягой>> через событие-дополнение. $Pr[A] = 1 - Pr[\overline{A}] = 1 - \frac{9^{15}}{10^{15}} = \frac{10^{15} - 9^{15}}{10^{15}}$ (всего затраков в которые не входит какой-то $i$-ый - $9^{15}$).

    Заметим, что $f = \sum_{i=1}^{10}g_i$. Тогда всилу линейности мат. ожидания:
    $$ E[f] = 
    E[\sum_{i=1}^{10} g_i] = \sum_{i=1}^{10} E[g_i] = 10 - \frac{9^{15}}{10^{14}} \approx 7.941 $$

    Т.е. проректор в среднем попробует около 8 различных завтраков.

    \textbf{Ответ:} $10 - \frac{9^{15}}{10^{14}}$.


    \paragraph{Задача 6.}
    Введем случайную величину $g_{ij}$ принимающую значение 1, если в $\pi$
    пара $i$ и $j$ образует инверсию и 0 - в противном случае.

    $E[g_{ij}] = \frac{1}{2} \cdot 1 + \frac{1}{2} \cdot 0 = \half{1}$, т.к. перестановок, в которых $\pair{i}{j}$ образует инверсию ровно столько же, сколько и тех, в которых они инверсию не образуют (можно установить биективное отношение).

    Но $I({\pi}) = \sum_{i=1}^{n - 1}\sum_{j=i + 1}^{n}g_{ij}$. Тогда 
    $E[I(\pi)] = \sum_{i=1}^{n - 1}\sum_{j=i + 1}^{n}E[g_{ij}] 
    = \sum_{i=1}^{n - 1}\sum_{j=i + 1}^{n} \half{1} = \frac{n(n-1)}{4}$.

    \textbf{Ответ:} $\frac{n(n-1)}{4}$.

    \paragraph{Задача 7.}
    $X$ - не отрицательная величина, значит $X \ge 6 \Leftrightarrow 2^X \ge 2^6.$ Тогда $Pr[X \ge 6] = Pr[2^X \ge 64]$. Применим неравенство Маркова:

    $$ Pr[2^X \ge 64] \le \frac{E[2^X]}{64} = \frac{5}{64} \approx 0.07 < \frac{1}{10}$$

    Что и требовалось доказать.

    \paragraph{Задача 8.}
    Пусть $g_i$ случайная величина, равная среднему числу жвачек, которых нужно купить, чтобы попался вкладыш, отличный от уже $i - 1$ имеющихся. В часности $g_1 = 1$.

    Посчитаем $g_k$, $1 \le k \le n$. Вероятность того, что очередной вкладыш отличен от $k - 1$ имеющихся - $p_k = \frac{n - (k - 1)}{n}$, так как все вкладыши равновероятны, а нас устраивают ровно $n - (k - 1)$ вкладышей. Среднее число покупок жвачек, чтобы попаласась жвачка вероятность которой $p_k$: $\frac{1}{p_k}$ (Пусть среднее число необходимых закупок $n$. Тогда $f$ - число жвачек с нужными вкладышами $f = \sum_{i=1}^{n}g_i$, где $g_i = 1$, если $i$ жвачка с нужным вкладышем. Тогда $E[f] = \sum_{i=1}^{n}E[g_i] = n \cdot (1 \cdot p_k + 0 \cdot (1 - p_k))$. Но раз $n$ - среднее число закупок, при которых требуемая живачка только одна, то понятно, что за $n$ покупок мы в среднем получим ровно одну жвачку, т.е. $E[f] = 1$. Отсюда $n = \frac{1}{p_k}$). Т.е. $E[g_k] = \frac{n}{n - k + 1}$.

    Если $f$ - случайная величина, равная среднему числу жвачек, которые нужно купить, чтобы собрать полную коллекцию, то $f = \sum_{i=1}^{n}g_i$. Тогда в силу линейности мат. ожидания:

    $$ E[f] = \sum_{i=1}^{n} E[g_i] = \sum_{i=1}^{n} \frac{n}{n - i + 1}.$$

    \textbf{Ответ:} $\sum_{i=1}^{n} \frac{n}{n - i + 1}$.
 \end{document}